/* Built at 2013-12-29 9:27:57 PM UTC 
   from https://github.com/abachman/jaws */
var jaws=function(a){function b(b){a.mouse_x=b.pageX||b.clientX,a.mouse_y=b.pageY||b.clientY;var c=a.canvas?a.canvas:a.dom;a.mouse_x-=c.offsetLeft,a.mouse_y-=c.offsetTop}var c,d;return a.Parallax=function(){a.log.error("To use jaws.Parallax() you need to include src/extras/parallax.js")},a.SpriteList=function(){a.log.error("To use SpriteList() you need to include src/extras/sprite_list.js")},a.TileMap=function(){a.log.error("To use TileMap() you need to include src/extras/tile_map.js")},a.PixelMap=function(){a.log.error("To use PixelMap() you need to include src/extras/pixel_map.js")},a.QuadTree=function(){a.log.error("To use QuadTree() you need to include src/extras/quadtree.js")},a.Audio=function(){a.log.error("To use jaws.Audio() you need to include src/extras/audio.js")},a.title=function(b){return a.isString(b)?b?c.innerHTML=b:c.innerHTML:(a.log.error("jaws.title: Passed in value is not a String."),void 0)},a.unpack=function(){var b=["Sprite","SpriteList","Animation","Viewport","SpriteSheet","Parallax","TileMap","pressed","QuadTree"];b.forEach(function(b){window[b]?a.log.warn("jaws.unpack: "+b+" already exists in global namespace."):window[b]=a[b]})},a.log=function(b,c){a.isString(b)||(b=JSON.stringify(b)),a.log.on&&(d&&a.log.use_log_element&&(c?d.innerHTML+=b+"<br />":d.innerHTML=b),console.log&&a.log.use_console&&console.log("JawsJS: ",b))},a.log.on=!0,a.log.use_console=!1,a.log.use_log_element=!0,a.log.warn=function(b){console.warn&&a.log.use_console&&a.log.on?console.warn(b):a.log("[WARNING]: "+JSON.stringify(b),!0)},a.log.error=function(b){console.error&&a.log.use_console&&a.log.on?console.error(b):a.log("[ERROR]: "+JSON.stringify(b),!0)},a.log.info=function(b){console.info&&a.log.use_console&&a.log.on?console.info(b):a.log("[INFO]: "+JSON.stringify(b),!0)},a.log.debug=function(b){console.debug&&a.log.use_console&&a.log.on?console.debug(b):a.log("[DEBUG]: "+JSON.stringify(b),!0)},a.log.clear=function(){d&&(d.innerHTML=""),console.clear&&console.clear()},a.init=function(e){c=document.getElementsByTagName("title")[0],a.url_parameters=a.getUrlParameters(),a.canvas=document.getElementsByTagName("canvas")[0],a.canvas||(a.dom=document.getElementById("canvas")),a.canvas?a.context=a.canvas.getContext("2d"):a.dom?a.dom.style.position="relative":(a.canvas=document.createElement("canvas"),a.canvas.width=e.width,a.canvas.height=e.height,a.context=a.canvas.getContext("2d"),document.body.appendChild(a.canvas)),d=document.getElementById("jaws-log"),a.url_parameters.debug&&(d||(d=document.createElement("div"),d.id="jaws-log",d.style.cssText="overflow: auto; color: #aaaaaa; width: 300px; height: 150px; margin: 40px auto 0px auto; padding: 5px; border: #444444 1px solid; clear: both; font: 10px verdana; text-align: left;",document.body.appendChild(d))),a.url_parameters.bust_cache&&(a.log.info("Busting cache when loading assets"),a.assets.bust_cache=!0),a.context&&a.useCrispScaling(),a.width=a.canvas?a.canvas.width:a.dom.offsetWidth,a.height=a.canvas?a.canvas.height:a.dom.offsetHeight,a.mouse_x=0,a.mouse_y=0,window.addEventListener("mousemove",b)},a.useCrispScaling=function(){a.context.imageSmoothingEnabled=!1,a.context.webkitImageSmoothingEnabled=!1,a.context.mozImageSmoothingEnabled=!1},a.useSmoothScaling=function(){a.context.imageSmoothingEnabled=!0,a.context.webkitImageSmoothingEnabled=!0,a.context.mozImageSmoothingEnabled=!0},a.start=function(b,c,d){function e(b,d){a.log.info(d+"%: "+b,!0),c.loading_screen&&a.assets.displayProgress(d)}function f(b,c){a.log.info(c+"%: Error loading asset "+b,!0)}function g(){a.log.info("all assets loaded",!0),a.switchGameState(b||window,{fps:h},d)}c||(c={});var h=c.fps||60;return void 0===c.loading_screen&&(c.loading_screen=!0),c.width||(c.width=500),c.height||(c.height=300),a.init(c),a.isFunction(b)||a.isObject(b)?a.isObject(d)||void 0===d?(c.loading_screen&&a.assets.displayProgress(0),a.log.info("setupInput()",!0),a.setupInput(),a.log.info("assets.loadAll()",!0),a.assets.length()>0?a.assets.loadAll({onprogress:e,onerror:f,onload:g}):g(),void 0):(a.log.error("jaws.start: The setup options for the game state is not an object."),void 0):(a.log.error("jaws.start: Passed in GameState is niether function or object"),void 0)},a.switchGameState=function(b,c,d){if(void 0===c&&(c={}),a.isFunction(b)&&(b=new b),!a.isObject(b))return a.log.error("jaws.switchGameState: Passed in GameState should be a Function or an Object."),void 0;var e=c&&c.fps||a.game_loop&&a.game_loop.fps||60,f=c.setup;a.game_loop&&a.game_loop.stop(),a.clearKeyCallbacks(),a.previous_game_state=a.game_state,a.game_state=b,a.game_loop=new a.GameLoop(b,{fps:e,setup:f},d),a.game_loop.start()},a.imageToCanvas=function(b){if(a.isCanvas(b))return b;if(!a.isImage(b))return a.log.error("jaws.imageToCanvas: Passed in object is not an Image."),void 0;var c=document.createElement("canvas");c.src=b.src,c.width=b.width,c.height=b.height;var d=c.getContext("2d");return d.drawImage(b,0,0,b.width,b.height),c},a.forceArray=function(a){return Array.isArray(a)?a:[a]},a.clear=function(){a.context.clearRect(0,0,a.width,a.height)},a.fill=function(b){a.context.fillStyle=b,a.context.fillRect(0,0,a.width,a.height)},a.draw=function(){var b=arguments;1==b.length&&a.isArray(b[0])&&(b=b[0]);for(var c=0;c<b.length;c++)a.isArray(b[c])?a.draw(b[c]):b[c].draw&&b[c].draw()},a.update=function(){var b=arguments;1==b.length&&a.isArray(b[0])&&(b=b[0]);for(var c=0;c<b.length;c++)a.isArray(b[c])?a.update(b[c]):b[c].update&&b[c].update()},a.isImage=function(a){return"[object HTMLImageElement]"===Object.prototype.toString.call(a)},a.isCanvas=function(a){return"[object HTMLCanvasElement]"===Object.prototype.toString.call(a)},a.isDrawable=function(b){return a.isImage(b)||a.isCanvas(b)},a.isString=function(a){return"string"==typeof a||"object"==typeof a&&a.constructor===String},a.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.isArray=function(a){return a?!(-1===a.constructor.toString().indexOf("Array")):!1},a.isObject=function(a){return null!==a&&"object"==typeof a},a.isFunction=function(a){return"[object Function]"===Object.prototype.toString.call(a)},a.isRegExp=function(a){return a instanceof RegExp},a.isOutsideCanvas=function(b){return b.x&&b.y?b.x<0||b.y<0||b.x>a.width||b.y>a.height:void 0},a.forceInsideCanvas=function(b){b.x&&b.y&&(b.x<0&&(b.x=0),b.x>a.width&&(b.x=a.width),b.y<0&&(b.y=0),b.y>a.height&&(b.y=a.height))},a.getUrlParameters=function(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b},a.parseOptions=function(b,c,d){b.options=c;for(var e in c)void 0===d[e]&&a.log.warn("jaws.parseOptions: Unsupported property "+e+"for "+b.constructor);for(var e in d)a.isFunction(d[e])&&(d[e]=d[e]()),b[e]=void 0!==c[e]?c[e]:a.clone(d[e])},a.clone=function(b){return a.isArray(b)?b.slice(0):a.isObject(b)?JSON.parse(JSON.stringify(b)):b},a.imageToCanvasContext=function(b){var c=document.createElement("canvas");c.width=b.width,c.height=b.height;var d=c.getContext("2d");return a.context&&(d.imageSmoothingEnabled=a.context.mozImageSmoothingEnabled,d.webkitImageSmoothingEnabled=a.context.mozImageSmoothingEnabled,d.mozImageSmoothingEnabled=a.context.mozImageSmoothingEnabled),d.drawImage(b,0,0,c.width,c.height),d},a.retroScaleImage=function(b,c){var d=a.isImage(b)?a.imageToCanvas(b):b,e=d.getContext("2d"),f=e.getImageData(0,0,d.width,d.height).data,g=document.createElement("canvas");g.width=b.width*c,g.height=b.height*c;for(var h=g.getContext("2d"),i=h.createImageData(g.width,g.height),j=i.width,k=i.height,l=0;k>l;l+=1)for(var m=Math.floor(l/c),n=l*i.width,o=m*b.width,p=0;j>p;p+=1){var q=Math.floor(p/c),r=4*(n+p),s=4*(o+q);i.data[r]=f[s],i.data[r+1]=f[s+1],i.data[r+2]=f[s+2],i.data[r+3]=f[s+3]}return h.putImageData(i,0,0),g},a}(jaws||{}),jaws=function(jaws){return jaws.Sprite=function(a){return this instanceof arguments.callee?(this.set(a),this.context=a.context?a.context:jaws.context,void 0):new arguments.callee(a)},jaws.Sprite.prototype.default_options={x:0,y:0,alpha:1,angle:0,flipped:!1,anchor_x:0,anchor_y:0,image:null,image_path:null,anchor:null,scale_image:null,damping:1,scale_x:1,scale_y:1,scale:1,color:"#ddd",width:16,height:16,_constructor:null,context:null,data:null},jaws.Sprite.prototype.set=function(a){if(jaws.isString(this.image)&&(this.image_path=this.image),jaws.parseOptions(this,a,this.default_options),this.scale&&(this.scale_x=this.scale_y=this.scale),this.image&&this.setImage(this.image),this.scale_image&&this.scaleImage(this.scale_image),this.anchor&&this.setAnchor(this.anchor),!this.image&&this.color&&this.width&&this.height){var b=document.createElement("canvas"),c=b.getContext("2d");b.width=this.width,b.height=this.height,c.fillStyle=this.color,c.fillRect(0,0,this.width,this.height),this.image=b}return this.cacheOffsets(),this},jaws.Sprite.prototype.clone=function(object){var constructor=this._constructor?eval(this._constructor):this.constructor,new_sprite=new constructor(this.attributes());return new_sprite._constructor=this._constructor||this.constructor.name,new_sprite},jaws.Sprite.prototype.setImage=function(a){var b=this;return jaws.isDrawable(a)?(this.image=a,this.cacheOffsets()):(jaws.assets.isLoaded(a)?(this.image=jaws.assets.get(a),this.cacheOffsets()):(jaws.log.warn("Image '"+a+"' not preloaded with jaws.assets.add(). Image and a working sprite.rect() will be delayed."),jaws.assets.load(a,{onload:function(){b.image=jaws.assets.get(a),b.cacheOffsets()}})),this)},jaws.Sprite.prototype.stepToWhile=function(a,b,c){var d=1,e=a<this.x?-d:d,f=b<this.y?-d:d;a=parseInt(a),b=parseInt(b);for(var g=!1,h=!1;;)if(g===!1&&(this.x!=a&&(this.x+=e),c(this)||(this.x-=e,g=!0)),h===!1&&(this.y!=b&&(this.y+=f),c(this)||(this.y-=f,h=!0)),(g||this.x==a)&&(h||this.y==b))return{x:g,y:h}},jaws.Sprite.prototype.stepWhile=function(a,b,c){return this.stepToWhile(this.x+a,this.y+b,c)},jaws.Sprite.prototype.flip=function(){return this.flipped=this.flipped?!1:!0,this},jaws.Sprite.prototype.flipTo=function(a){return this.flipped=a,this},jaws.Sprite.prototype.rotate=function(a){return this.angle+=a,this},jaws.Sprite.prototype.rotateTo=function(a){return this.angle=a,this},jaws.Sprite.prototype.moveTo=function(a,b){return jaws.isArray(a)&&void 0===b&&(b=a[1],a=a[0]),this.x=a,this.y=b,this},jaws.Sprite.prototype.move=function(a,b){return jaws.isArray(a)&&void 0===b&&(b=a[1],a=a[0]),a&&(this.x+=a),b&&(this.y+=b),this},jaws.Sprite.prototype.scaleAll=function(a){return this.scale_x*=a,this.scale_y*=a,this.cacheOffsets()},jaws.Sprite.prototype.scaleTo=function(a){return this.scale_x=this.scale_y=a,this.cacheOffsets()},jaws.Sprite.prototype.scaleWidth=function(a){return this.scale_x*=a,this.cacheOffsets()},jaws.Sprite.prototype.scaleHeight=function(a){return this.scale_y*=a,this.cacheOffsets()},jaws.Sprite.prototype.setX=function(a){return this.x=a,this},jaws.Sprite.prototype.setY=function(a){return this.y=a,this},jaws.Sprite.prototype.setTop=function(a){return this.y=a+this.top_offset,this},jaws.Sprite.prototype.setBottom=function(a){return this.y=a-this.bottom_offset,this},jaws.Sprite.prototype.setLeft=function(a){return this.x=a+this.left_offset,this},jaws.Sprite.prototype.setRight=function(a){return this.x=a-this.right_offset,this},jaws.Sprite.prototype.setWidth=function(a){return this.scale_x=a/this.image.width,this.cacheOffsets()},jaws.Sprite.prototype.setHeight=function(a){return this.scale_y=a/this.image.height,this.cacheOffsets()},jaws.Sprite.prototype.resize=function(a,b){return jaws.isArray(a)&&void 0===b&&(b=a[1],a=a[0]),this.scale_x=(this.width+a)/this.image.width,this.scale_y=(this.height+b)/this.image.height,this.cacheOffsets()},jaws.Sprite.prototype.resizeTo=function(a,b){return jaws.isArray(a)&&void 0===b&&(b=a[1],a=a[0]),this.scale_x=a/this.image.width,this.scale_y=b/this.image.height,this.cacheOffsets()},jaws.Sprite.prototype.setAnchor=function(b){var c={top_left:[0,0],left_top:[0,0],center_left:[0,.5],left_center:[0,.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[.5,0],center_top:[.5,0],center_center:[.5,.5],center:[.5,.5],bottom_center:[.5,1],center_bottom:[.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,.5],right_center:[1,.5],bottom_right:[1,1],right_bottom:[1,1]};return(a=c[b])&&(this.anchor_x=a[0],this.anchor_y=a[1],this.image&&this.cacheOffsets()),this},jaws.Sprite.prototype.cacheOffsets=function(){return this.image?(this.width=this.image.width*this.scale_x,this.height=this.image.height*this.scale_y,this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=this.width*(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this):void 0},jaws.Sprite.prototype.rect=function(){return!this.cached_rect&&this.width&&(this.cached_rect=new jaws.Rect(this.x,this.y,this.width,this.height)),this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset),this.cached_rect},jaws.Sprite.prototype.draw=function(){return this.image?(this.context.save(),this.context.translate(this.x,this.y),0!=this.angle&&jaws.context.rotate(this.angle*Math.PI/180),this.flipped&&this.context.scale(-1,1),this.context.globalAlpha=this.alpha,this.context.translate(-this.left_offset,-this.top_offset),this.context.drawImage(this.image,0,0,this.width,this.height),this.context.restore(),this):this},jaws.Sprite.prototype.scaleImage=function(a){return this.image?(this.setImage(jaws.retroScaleImage(this.image,a)),this):void 0},jaws.Sprite.prototype.asCanvasContext=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height;var b=a.getContext("2d");return jaws.context&&(b.mozImageSmoothingEnabled=jaws.context.mozImageSmoothingEnabled),b.drawImage(this.image,0,0,this.width,this.height),b},jaws.Sprite.prototype.asCanvas=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height;var b=a.getContext("2d");return jaws.context&&(b.mozImageSmoothingEnabled=jaws.context.mozImageSmoothingEnabled),b.drawImage(this.image,0,0,this.width,this.height),a},jaws.Sprite.prototype.toString=function(){return"[Sprite "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"},jaws.Sprite.prototype.attributes=function(){var a={};return a._constructor=this._constructor||"jaws.Sprite",a.x=parseFloat(this.x.toFixed(2)),a.y=parseFloat(this.y.toFixed(2)),a.image=this.image_path,a.alpha=this.alpha,a.flipped=this.flipped,a.angle=parseFloat(this.angle.toFixed(2)),a.scale_x=this.scale_x,a.scale_y=this.scale_y,a.anchor_x=this.anchor_x,a.anchor_y=this.anchor_y,null!==this.data&&(a.data=jaws.clone(this.data)),a},jaws.Sprite.parse=function(objects){function parseArray(array){array.forEach(function(data){var constructor=data._constructor?eval(data._constructor):data.constructor;if(jaws.isFunction(constructor)){jaws.log.info("Creating "+data._constructor+"("+data.toString()+")",!0);var object=new constructor(data);object._constructor=data._constructor||data.constructor.name,sprites.push(object)}})}var sprites=[];return jaws.isArray(objects)?objects.every(function(a){return a._constructor})?parseArray(objects):sprites=objects:jaws.isString(objects)&&(parseArray(JSON.parse(objects)),jaws.log.info(objects)),sprites},jaws.Sprite.prototype.toJSON=function(){return JSON.stringify(this.attributes())},jaws}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.Sprite);var jaws=function(a){return a.Animation=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);if(a.parseOptions(this,b,this.default_options),b.sprite_sheet){var c=new a.SpriteSheet({image:b.sprite_sheet,scale_image:this.scale_image,frame_size:this.frame_size,orientation:this.orientation,offset:this.offset});this.frames=c.frames,this.frame_size=c.frame_size}if(b.scale_image){var d=a.isDrawable(b.sprite_sheet)?b.sprite_sheet:a.assets.get(b.sprite_sheet);this.frame_size[0]*=b.scale_image,this.frame_size[1]*=b.scale_image,b.sprite_sheet=a.retroScaleImage(d,b.scale_image)}if(this.current_tick=(new Date).getTime(),this.last_tick=(new Date).getTime(),this.sum_tick=0,b.subsets){this.subsets={};for(subset in b.subsets)start_stop=b.subsets[subset],this.subsets[subset]=this.slice(start_stop[0],start_stop[1])}},a.Animation.prototype.default_options={frames:[],subsets:[],frame_duration:100,index:0,loop:1,bounce:0,frame_direction:1,frame_size:null,orientation:"down",on_end:null,offset:0,scale_image:null,sprite_sheet:null},a.Animation.prototype.subset=function(a){return this.subsets[a]},a.Animation.prototype.update=function(){return this.current_tick=(new Date).getTime(),this.sum_tick+=this.current_tick-this.last_tick,this.last_tick=this.current_tick,this.sum_tick>this.frame_duration&&(this.index+=this.frame_direction,this.sum_tick=0),(this.index>=this.frames.length||this.index<0)&&(this.bounce?(this.frame_direction=-this.frame_direction,this.index+=2*this.frame_direction):this.loop?this.index=this.frame_direction<0?this.frames.length-1:0:(this.index-=this.frame_direction,this.on_end&&(this.on_end(),this.on_end=null))),this},a.Animation.prototype.slice=function(b,c){var d={};return d.frame_duration=this.frame_duration,d.loop=this.loop,d.bounce=this.bounce,d.on_end=this.on_end,d.frame_direction=this.frame_direction,d.frames=this.frames.slice().slice(b,c),new a.Animation(d)},a.Animation.prototype.next=function(){return this.update(),this.frames[this.index]},a.Animation.prototype.atLastFrame=function(){return this.index==this.frames.length-1},a.Animation.prototype.atFirstFrame=function(){return 0==this.index},a.Animation.prototype.currentFrame=function(){return this.frames[this.index]},a.Animation.prototype.toString=function(){return"[Animation, "+this.frames.length+" frames]"},a}(jaws||{}),jaws=function(a){function b(b){if(a.isDrawable(b)){for(var c=a.isImage(b)?a.imageToCanvas(b):b,d=c.getContext("2d"),e=d.getImageData(0,0,c.width,c.height),f=e.data,g=0;g<f.length;g+=4)255===f[g]&&0===f[g+1]&&255===f[g+2]&&(f[g+3]=0);return d.putImageData(e,0,0),c}}return a.Assets=function(){function c(b){if(a.isString(b)){var c=h.getPostfix(b);return h.file_type[c]?h.file_type[c]:c}a.log.error("jaws.assets.getType: Argument not a String with "+b)}function d(d){var e=this.asset,f=e.src,i=c(e.src);try{if("json"===i){if(4!==this.readyState)return;h.data[e.src]=JSON.parse(this.responseText)}else if("image"===i){var j=h.image_to_canvas?a.imageToCanvas(e.image):e.image;h.fuchia_to_transparent&&"bmp"===h.getPostfix(e.src)&&(j=b(j)),h.data[e.src]=j}else h.data[e.src]="audio"===i&&h.can_play[h.getPostfix(e.src)]?e.audio:"video"===i&&h.can_play[h.getPostfix(e.src)]?e.video:this.response}catch(k){a.log.error("Cannot process "+f+" (Message: "+k.message+", Name: "+k.name+")"),h.data[e.src]=null}h.loaded[f]||h.load_count++,h.loaded[f]=!0,h.loading[f]=!1,g(e,!0,d)}function e(a){h.loaded[a.src]=!0,h.loading[a.src]=!1,h.load_count++,g(a,!0)}function f(a){var b=this.asset;h.error_count++,g(b,!1,a)}function g(a,b,c){var d=parseInt((h.load_count+h.error_count)/h.src_list.length*100);b?(h.onprogress&&h.onprogress(a.src,d),a.onprogress&&void 0!==c&&a.onprogress(c)):(h.onerror&&h.onerror(a.src,d),a.onerror&&void 0!==c&&a.onerror(c)),100===d&&(h.onload&&h.onload(),h.onprogress=null,h.onerror=null,h.onload=null)}if(!(this instanceof arguments.callee))return new arguments.callee;var h=this;h.loaded=[],h.loading=[],h.src_list=[],h.data=[],h.bust_cache=!1,h.image_to_canvas=!0,h.fuchia_to_transparent=!0,h.root="",h.file_type={},h.file_type.json="json",h.file_type.wav="audio",h.file_type.mp3="audio",h.file_type.ogg="audio",h.file_type.m4a="audio",h.file_type.weba="audio",h.file_type.aac="audio",h.file_type.mka="audio",h.file_type.flac="audio",h.file_type.png="image",h.file_type.jpg="image",h.file_type.jpeg="image",h.file_type.gif="image",h.file_type.bmp="image",h.file_type.tiff="image",h.file_type.mp4="video",h.file_type.webm="video",h.file_type.ogv="video",h.file_type.mkv="video";var i=new Audio,j=document.createElement("video");h.can_play={},h.can_play.wav=!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),h.can_play.ogg=!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),h.can_play.mp3=!!i.canPlayType("audio/mpeg;").replace(/^no$/,""),h.can_play.m4a=!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),h.can_play.weba=!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),h.can_play.aac=!!i.canPlayType("audio/aac;").replace(/^no$/,""),h.can_play.mka=!!i.canPlayType("audio/x-matroska;").replace(/^no$/,""),h.can_play.flac=!!i.canPlayType("audio/x-flac;").replace(/^no$/,""),h.can_play.mp4=!!j.canPlayType("video/mp4;").replace(/^no$/,""),h.can_play.webm=!!j.canPlayType('video/webm; codecs="vorbis"').replace(/^no$/,""),h.can_play.ogv=!!j.canPlayType('video/ogg; codecs="vorbis"').replace(/^no$/,""),h.can_play.mkv=!!j.canPlayType("video/x-matroska;").replace(/^no$/,""),h.length=function(){return h.src_list.length},h.setRoot=function(a){return h.root=a,h},h.get=function(b){if(a.isArray(b))return b.map(function(a){return h.data[a]});if(!a.isString(b))return a.log.error("jaws.get: Neither String nor Array. Incorrect URL resource "+b),void 0;if("*"===b[b.length-1])for(var c=b.replace("*",""),d=0;d<h.src_list.length;d++)if(0==h.src_list[d].indexOf(c)&&h.data[h.src_list[d]])return h.data[h.src_list[d]];return h.data[b]?h.data[b]:(a.log.warn("No such asset: "+b,!0),void 0)},h.isLoading=function(b){return a.isString(b)?h.loading[b]:(a.log.error("jaws.isLoading: Argument not a String with "+b),void 0)},h.isLoaded=function(b){return a.isString(b)?h.loaded[b]:(a.log.error("jaws.isLoaded: Argument not a String with "+b),void 0)},h.getPostfix=function(b){return a.isString(b)?b.toLowerCase().match(/.+\.([^?]+)(\?|$)/)[1]:(a.log.error("jaws.assets.getPostfix: Argument not a String with "+b),void 0)},h.add=function(b){var c=arguments;1==c.length&&a.isArray(c[0])&&(c=c[0]);for(var d=0;d<c.length;d++)a.isArray(c[d])?h.add(c[d]):a.isString(c[d])?h.src_list.push(c[d]):a.log.error("jaws.assets.add: Neither String nor Array. Incorrect URL resource "+b);return h},h.loadAll=function(b){return h.load_count=0,h.error_count=0,b.onprogress&&a.isFunction(b.onprogress)&&(h.onprogress=b.onprogress),b.onerror&&a.isFunction(b.onerror)&&(h.onerror=b.onerror),b.onload&&a.isFunction(b.onload)&&(h.onload=b.onload),h.src_list.forEach(function(a){h.load(a)}),h},h.load=function(b,g){if(g||(g={}),!a.isString(b))return a.log.error("jaws.assets.load: Argument not a String with "+b),void 0;var i={},j="";i.src=b,i.onload=g.onload,i.onerror=g.onerror,h.loading[b]=!0;var k=RegExp("^((f|ht)tp(s)?:)?//");j=k.test(b)?i.src:h.root+i.src,h.bust_cache&&(j+="?"+parseInt(1e7*Math.random()));var l=c(i.src);if("image"===l)try{i.image=new Image,i.image.asset=i,i.image.addEventListener("load",d),i.image.addEventListener("error",f),i.image.src=j}catch(m){a.log.error("Cannot load Image resource "+j+" (Message: "+m.message+", Name: "+m.name+")")}else if(h.can_play[h.getPostfix(i.src)]){if("audio"===l)try{i.audio=new Audio,i.audio.asset=i,i.audio.addEventListener("error",f),i.audio.addEventListener("canplay",d),h.data[i.src]=i.audio,i.audio.src=j,i.audio.load()}catch(m){a.log.error("Cannot load Audio resource "+j+" (Message: "+m.message+", Name: "+m.name+")")}else if("video"===l)try{i.video=document.createElement("video"),i.video.asset=i,h.data[i.src]=i.video,i.video.setAttribute("style","display:none;"),i.video.addEventListener("error",f),i.video.addEventListener("canplay",d),document.body.appendChild(i.video),i.video.src=j,i.video.load()}catch(m){a.log.error("Cannot load Video resource "+j+" (Message: "+m.message+", Name: "+m.name+")")}}else{if("audio"===l&&!h.can_play[h.getPostfix(i.src)])return e(i),h;try{var n=new XMLHttpRequest;n.asset=i,n.onreadystatechange=d,n.onerror=f,n.open("GET",j,!0),"json"!==l&&(n.responseType="blob"),n.send(null)}catch(m){a.log.error("Cannot load "+j+" (Message: "+m.message+", Name: "+m.name+")")}}return h},h.displayProgress=function(b){a.isNumber(b)&&a.context&&(a.context.save(),a.context.fillStyle="black",a.context.fillRect(0,0,a.width,a.height),a.context.fillStyle="white",a.context.strokeStyle="white",a.context.textAlign="center",a.context.strokeRect(49,a.height/2-30-1,a.width-100+2,62),a.context.fillRect(50,a.height/2-30,(a.width-100)/100*b,60),a.context.font="11px verdana",a.context.fillText("Loading... "+b+"%",a.width/2,a.height/2-35),a.context.font="11px verdana",a.context.fillStyle="#ccc",a.context.textBaseline="bottom",a.context.fillText("powered by www.jawsjs.com",a.width/2,a.height-1),a.context.restore())}},a.assets=new a.Assets,a}(jaws||{}),jaws=function(a){function b(a,b){for(var c=function(b){return void 0!==a.isSpriteList?a.at(b):a[b]},d=[],e=new Array(b),f=0;b>f;f++)e[f]=f;for(var f=b-1,g=a.length;f>=0;g=a.length){for(d.push(e.map(c));f>=0&&e[f]===g-1;)f--,g--;if(f>=0){e[f]+=1;for(var h=f+1;b>h;h++)e[h]=e[h-1]+1;f=b-1}}return d}return a.collideOneWithOne=function(b,c){return b.radius&&c.radius&&b!==c&&a.collideCircles(b,c)?!0:b.rect&&c.rect&&b!==c&&a.collideRects(b.rect(),c.rect())?!0:!1},a.collideOneWithMany=function(b,c,d){var e=[];if(d){for(var f=0;f<c.length;f++)a.collideOneWithOne(b,c[f])&&(d(b,c[f]),e.push(c[f]));return e}return c.filter(function(c){return a.collideOneWithOne(b,c)})},a.collideManyWithMany=function(c,d,e){var f=[];return c===d?b(c,2).forEach(function(b){a.collideOneWithOne(b[0],b[1])&&(e?e(b[0],b[1]):f.push([b[0],b[1]]))}):c.forEach(function(b){d.forEach(function(c){a.collideOneWithOne(b,c)&&(e?e(b,c):f.push([b,c]))})}),f},a.collideCircles=function(b,c){return a.distanceBetween(b,c)<b.radius+c.radius},a.collideRects=function(a,b){return(a.x>=b.x&&a.x<=b.right||b.x>=a.x&&b.x<=a.right)&&(a.y>=b.y&&a.y<=b.bottom||b.y>=a.y&&b.y<=a.bottom)},a.distanceBetween=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},a.collide=function(b,c,d){if(b.rect&&c.forEach)return a.collideOneWithMany(b,c,d).length>0;if(b.forEach&&c.forEach)return a.collideManyWithMany(b,c,d).length>0;if(b.forEach&&c.rect)return a.collideOneWithMany(c,b,d).length>0;if(b.rect&&c.rect){var e=a.collideOneWithOne(b,c);if(!d||!e)return e;d(b,c)}},a}(jaws||{}),jaws=function(a){function b(a){this.size=a,this.values=new Array(this.size),this.value,this.add=function(a){if(this.values.length>this.size){this.values.splice(0,1),this.value=0;for(var b=0;this.values[b];b++)this.value+=this.values[b];this.value=this.value/this.size}return this.values.push(a),this},this.get=function(){return parseInt(this.value)}}return window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,16.666)}}(),a.GameLoop=function(c,d,e){if(!(this instanceof arguments.callee))return new arguments.callee(c,d);this.tick_duration=0,this.fps=0,this.ticks=0;var f,g=!1,h=!1,i=this,j=new b(20);this.runtime=function(){return this.last_tick-this.first_tick},this.start=function(){a.log.info("Game loop start",!0),this.first_tick=(new Date).getTime(),this.current_tick=(new Date).getTime(),this.last_tick=(new Date).getTime(),d.setup!==!1&&c.setup&&c.setup(e),step_delay=1e3/d.fps,60==d.fps?requestAnimFrame(this.loop):f=setInterval(this.loop,step_delay)},this.loop=function(){i.current_tick=(new Date).getTime(),i.tick_duration=i.current_tick-i.last_tick,i.fps=j.add(1e3/i.tick_duration).get(),h||g||(c.update&&c.update(),c.draw&&c.draw(),i.ticks++),60!=d.fps||h||requestAnimFrame(i.loop),i.last_tick=i.current_tick},this.pause=function(){g=!0},this.unpause=function(){g=!1},this.stop=function(){f&&clearInterval(f),h=!0}},a}(jaws||{}),jaws=function(a){function b(){i={}}function c(a){event=a?a:window.event;var b=k[event.keyCode].split(" ");b.forEach(function(b){i[b]=!1,m[b]&&(m[b](b),a.preventDefault()),p[b]&&a.preventDefault()})}function d(a){event=a?a:window.event;var b=k[event.keyCode].split(" ");b.forEach(function(b){i[b]=!0,l[b]&&(l[b](b),a.preventDefault()),p[b]&&a.preventDefault()})}function e(a){event=a?a:window.event;var b=n[event.button];"Microsoft Internet Explorer"==navigator.appName&&(b=o[event.button]),i[b]=!0,l[b]&&(l[b](b),a.preventDefault())}function f(a){event=a?a:window.event;var b=n[event.button];"Microsoft Internet Explorer"==navigator.appName&&(b=o[event.button]),i[b]=!1,m[b]&&(m[b](b),a.preventDefault())}function g(b){event=b?b:window.event,i.left_mouse_button=!0,a.mouse_x=b.touches[0].pageX-a.canvas.offsetLeft,a.mouse_y=b.touches[0].pageY-a.canvas.offsetTop}function h(b){event=b?b:window.event,i.left_mouse_button=!1,a.mouse_x=void 0,a.mouse_y=void 0}var i={},j={},k=[],l=[],m=[],n=[],o=[];a.setupInput=function(){var i=[];i[8]="backspace",i[9]="tab",i[13]="enter",i[16]="shift",i[17]="ctrl",i[18]="alt",i[19]="pause",i[20]="capslock",i[27]="esc",i[32]="space",i[33]="pageup",i[34]="pagedown",i[35]="end",i[36]="home",i[37]="left",i[38]="up",i[39]="right",i[40]="down",i[45]="insert",i[46]="delete",i[91]="left_window_key leftwindowkey",i[92]="right_window_key rightwindowkey",i[93]="select_key selectkey",i[106]="multiply *",i[107]="add plus +",i[109]="subtract minus -",i[110]="decimalpoint",i[111]="divide /",i[144]="numlock",i[145]="scrollock",i[186]="semicolon ;",i[187]="equalsign =",i[188]="comma ,",i[189]="dash -",i[190]="period .",i[191]="forwardslash /",i[192]="graveaccent `",i[219]="openbracket [",i[220]="backslash \\",i[221]="closebracket ]",i[222]="singlequote '";var j=[];j[0]="left_mouse_button",j[1]="center_mouse_button",j[2]="right_mouse_button";var l=[];l[1]="left_mouse_button",l[2]="right_mouse_button",l[4]="center_mouse_button",n=j,o=l;for(var m=["numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9"],p=["f1","f2","f3","f4","f5","f6","f7","f8","f9"],q=["0","1","2","3","4","5","6","7","8","9"],r=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],s=0;q[s];s++)i[48+s]=q[s];for(var s=0;r[s];s++)i[65+s]=r[s];for(var s=0;m[s];s++)i[96+s]=m[s];for(var s=0;p[s];s++)i[112+s]=p[s];k=i,window.addEventListener("keydown",d),window.addEventListener("keyup",c);var t=a.canvas||a.dom;t.addEventListener("mousedown",e,!1),t.addEventListener("mouseup",f,!1),t.addEventListener("touchstart",g,!1),t.addEventListener("touchend",h,!1),window.addEventListener("blur",b,!1),document.oncontextmenu=function(){return!1}};var p=[];return a.preventDefaultKeys=function(){var b=arguments;1==b.length&&a.isArray(b[0])&&(b=b[0]);for(var c=0;c<b.length;c++)p[b[c]]=!0},a.pressed=function(b,c){return a.isString(b)&&(b=b.split(" ")),c?b.every(function(a){return i[a]}):b.some(function(a){return i[a]})},a.pressedWithoutRepeat=function(b,c){return a.pressed(b,c)?j[b]?void 0:(j[b]=!0,!0):(j[b]=!1,!1)},a.on_keydown=function(b,c){if(a.isArray(b))for(var d=0;b[d];d++)l[b[d]]=c;else l[b]=c},a.on_keyup=function(b,c){if(a.isArray(b))for(var d=0;b[d];d++)m[b[d]]=c;else m[b]=c},a.clearKeyCallbacks=function(){m=[],l=[]},a}(jaws||{}),jaws=function(a){return a.Parallax=function(b){return this instanceof arguments.callee?(a.parseOptions(this,b,this.default_options),void 0):new arguments.callee(b)},a.Parallax.prototype.default_options={width:function(){return a.width},height:function(){return a.height},scale:1,repeat_x:null,repeat_y:null,camera_x:0,camera_y:0,layers:[]},a.Parallax.prototype.draw=function(){for(var a,b,c=0;c<this.layers.length;c++)for(a=this.layers[c],b=this.repeat_x?-(this.camera_x/a.damping%a.width):-(this.camera_x/a.damping),a.y=this.repeat_y?-(this.camera_y/a.damping%a.height):-(this.camera_y/a.damping),a.x=b;a.y<this.height;){for(;a.x<this.width&&(a.x+a.width>=0&&a.y+a.height>=0&&a.draw(),a.x=a.x+a.width,this.repeat_x););if(a.y=a.y+a.height,a.x=b,!this.repeat_y)break}},a.Parallax.prototype.addLayer=function(b){var c=new a.ParallaxLayer(b);c.scaleAll(this.scale),this.layers.push(c)
},a.Parallax.prototype.toString=function(){return"[Parallax "+this.x+", "+this.y+". "+this.layers.length+" layers]"},a.ParallaxLayer=function(b){return this instanceof arguments.callee?(this.damping=b.damping||0,a.Sprite.call(this,b),void 0):new arguments.callee(b)},a.ParallaxLayer.prototype=a.Sprite.prototype,a}(jaws||{}),jaws=function(a){return a.PixelMap=function(b){return this instanceof arguments.callee?(this.options=b,this.scale=b.scale||1,this.x=b.x||0,this.y=b.y||0,b.image?(this.setContext(b.image),b.scale_image&&this.setContext(a.retroScaleImage(this.context.canvas,b.scale_image)),this.width=this.context.canvas.width*this.scale,this.height=this.context.canvas.height*this.scale):a.log.warn("PixelMap needs an image to work with"),this.named_colors=[],this.update(),void 0):new arguments.callee(b)},a.PixelMap.prototype.setContext=function(b){var b=a.isDrawable(b)?b:a.assets.get(b);this.context=a.imageToCanvasContext(b)},a.PixelMap.prototype.update=function(a,b,c,d){if((void 0===a||0>a)&&(a=0),(void 0===b||0>b)&&(b=0),(void 0===c||c>this.width)&&(c=this.width),(void 0===d||d>this.height)&&(d=this.height),0==arguments.length)this.data=this.context.getImageData(a,b,c,d).data;else for(var e=this.context.getImageData(a,b,c,d).data,f=0,g=4*this.width,h=b*this.width*4+4*a,i=4*c,j=0;d>j;j++){for(var k=0;i>k;k++)this.data[h+k]=e[f++];h+=g}},a.PixelMap.prototype.draw=function(){a.context.drawImage(this.context.canvas,this.x,this.y,this.width,this.height)},a.PixelMap.prototype.namedColorAtRect=function(a,b){for(var c=a.x,d=a.y;c<a.right-1;c++)if(this.namedColorAt(c,d)==b||void 0===b)return this.namedColorAt(c,d);for(;d<a.bottom-1;d++)if(this.namedColorAt(c,d)==b||void 0===b)return this.namedColorAt(c,d);for(;c>a.x;c--)if(this.namedColorAt(c,d)==b||void 0===b)return this.namedColorAt(c,d);for(;d>a.y;d--)if(this.namedColorAt(c,d)==b||void 0===b)return this.namedColorAt(c,d);return!1},a.PixelMap.prototype.at=function(a,b){a=parseInt(a),b=parseInt(b),0>b&&(b=0);var c=b*this.width*4+4*a,d=this.data[c],e=this.data[c+1],f=this.data[c+2],g=this.data[c+3];return[d,e,f,g]},a.PixelMap.prototype.namedColorAt=function(a,b){for(var c=this.at(a,b),d=0;d<this.named_colors.length;d++){var e=this.named_colors[d].name,f=this.named_colors[d].color;if(f[0]==c[0]&&f[1]==c[1]&&f[2]==c[2]&&f[3]==c[3])return e}},a.PixelMap.prototype.nameColor=function(a,b){this.named_colors.push({name:b,color:a})},a}(jaws||{}),jaws=function(a){return a.QuadTree=function(b){this.depth=arguments[1]||0,this.bounds=b||new a.Rect(0,0,a.width,a.height),this.nodes=[],this.objects=[]},a.QuadTree.prototype.clear=function(){this.objects=[];for(var a=0;a<this.nodes.length;a++)"undefined"!=typeof this.nodes[a]&&(this.nodes[a].clear(),delete this.nodes[a])},a.QuadTree.prototype.split=function(){var b=Math.round(this.bounds.width/2),c=Math.round(this.bounds.height/2),d=this.bounds.x,e=this.bounds.y;this.nodes[0]=new a.QuadTree(new a.Rect(d+b,e,b,c),this.depth+1),this.nodes[1]=new a.QuadTree(new a.Rect(d,e,b,c),this.depth+1),this.nodes[2]=new a.QuadTree(new a.Rect(d,e+c,b,c),this.depth+1),this.nodes[3]=new a.QuadTree(new a.Rect(d+b,e+c,b,c),this.depth+1)},a.QuadTree.prototype.getIndex=function(a){var b=-1,c=this.bounds.x+this.bounds.width/2,d=this.bounds.y+this.bounds.height/2,e=a.y<d&&a.y+a.height<d,f=a.y>d;return a.x<c&&a.x+a.width<c?e?b=1:f&&(b=2):a.x>c&&(e?b=0:f&&(b=3)),b},a.QuadTree.prototype.insert=function(a){if(a.hasOwnProperty("x")||a.hasOwnProperty("y")||a.hasOwnProperty("width")||a.hasOwnProperty("height")){if("undefined"!=typeof this.nodes[0]){var b=this.getIndex(a);if(-1!==b)return this.nodes[b].insert(a),void 0}this.objects.push(a),"undefined"==typeof this.nodes[0]&&this.split();for(var c=0;c<this.objects.length;){var b=this.getIndex(this.objects[c]);-1!==b?this.nodes[b].insert(this.objects.splice(c,1)[0]):c++}}},a.QuadTree.prototype.retrieve=function(a){if(a.hasOwnProperty("x")||a.hasOwnProperty("y")||a.hasOwnProperty("width")||a.hasOwnProperty("height")){var b=this.getIndex(a),c=this.objects;if("undefined"!=typeof this.nodes[0])if(-1!==b)c=c.concat(this.nodes[b].retrieve(a));else for(var d=0;d<this.nodes.length;d++)c=c.concat(this.nodes[d].retrieve(a));return c}},a.QuadTree.prototype.collide=function(b,c,d){var e=!1,f=new a.QuadTree,g=[];return b.forEach||(g.push(b),b=g),c.forEach||(g=[],g.push(c),c=g),c.forEach(function(a){f.insert(a)}),b.forEach(function(b){a.collide(b,f.retrieve(b),d)&&(e=!0)}),f.clear(),e},a}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.QuadTree);var jaws=function(a){var b=0;return a.Rect=function(a,c,d,e){return this instanceof arguments.callee?(this.x=a,this.y=c,this.width=d,this.height=e,this.right=a+d-b,this.bottom=c+e-b,void 0):new arguments.callee(a,c,d,e)},a.Rect.prototype.getPosition=function(){return[this.x,this.y]},a.Rect.prototype.move=function(a,b){return this.x+=a,this.y+=b,this.right+=a,this.bottom+=b,this},a.Rect.prototype.moveTo=function(a,c){return this.x=a,this.y=c,this.right=this.x+this.width-b,this.bottom=this.y+this.height-b,this},a.Rect.prototype.resize=function(a,c){return this.width+=a,this.height+=c,this.right=this.x+this.width-b,this.bottom=this.y+this.height-b,this},a.Rect.prototype.clone=function(){return new a.Rect(this.x,this.y,this.width,this.height)},a.Rect.prototype.shrink=function(a,c){return this.x+=a,this.y+=c,this.width-=a+a,this.height-=c+c,this.right=this.x+this.width-b,this.bottom=this.y+this.height-b,this},a.Rect.prototype.resizeTo=function(a,c){return this.width=a,this.height=c,this.right=this.x+this.width-b,this.bottom=this.y+this.height-b,this},a.Rect.prototype.draw=function(){return a.context.strokeStyle="red",a.context.strokeRect(this.x-.5,this.y-.5,this.width,this.height),this},a.Rect.prototype.collidePoint=function(a,b){return a>=this.x&&a<=this.right&&b>=this.y&&b<=this.bottom},a.Rect.prototype.collideRect=function(a){return(this.x>=a.x&&this.x<=a.right||a.x>=this.x&&a.x<=this.right)&&(this.y>=a.y&&this.y<=a.bottom||a.y>=this.y&&a.y<=this.bottom)},a.Rect.prototype.toString=function(){return"[Rect "+this.x+", "+this.y+", "+this.width+", "+this.height+"]"},a}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.Rect);var jaws=function(a){function b(a,b,c,d,e){var f=document.createElement("canvas");f.width=d,f.height=e;var g=f.getContext("2d");return g.drawImage(a,b,c,d,e,0,0,f.width,f.height),f}return a.SpriteSheet=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);if(a.parseOptions(this,c,this.default_options),a.isString(this.image)&&!c.frame_size){var d=new RegExp("_(\\d+)x(\\d+)","g"),e=d.exec(this.image);this.frame_size=[],this.frame_size[0]=parseInt(e[1]),this.frame_size[1]=parseInt(e[2])}if(this.image=a.isDrawable(this.image)?this.image:a.assets.data[this.image],this.scale_image){var f=a.isDrawable(this.image)?this.image:a.assets.get(this.image);this.frame_size[0]*=this.scale_image,this.frame_size[1]*=this.scale_image,this.image=a.retroScaleImage(f,this.scale_image)}if(this.frames=[],"down"==this.orientation)for(var g=this.offset;g<this.image.width;g+=this.frame_size[0])for(var h=0;h<this.image.height;h+=this.frame_size[1])this.frames.push(b(this.image,g,h,this.frame_size[0],this.frame_size[1]));else for(var h=this.offset;h<this.image.height;h+=this.frame_size[1])for(var g=0;g<this.image.width;g+=this.frame_size[0])this.frames.push(b(this.image,g,h,this.frame_size[0],this.frame_size[1]))},a.SpriteSheet.prototype.default_options={image:null,orientation:"down",frame_size:[32,32],offset:0,scale_image:null},a.SpriteSheet.prototype.toString=function(){return"[SpriteSheet "+this.frames.length+" frames]"},a}(jaws||{}),jaws=function(jaws){return jaws.Text=function(a){return this instanceof arguments.callee?(this.set(a),a.context&&(this.context=a.context),a.context||jaws.context&&(this.context=jaws.context),void 0):new arguments.callee(a)},jaws.Text.prototype.default_options={x:0,y:0,alpha:1,angle:0,anchor_x:0,anchor_y:0,anchor:"top_left",damping:1,style:"normal",fontFace:"serif",fontSize:12,color:"black",textAlign:"start",textBaseline:"alphabetic",text:"",wordWrap:!1,width:function(){return jaws.width},height:function(){return jaws.height},shadowColor:null,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,_constructor:null},jaws.Text.prototype.set=function(a){return jaws.parseOptions(this,a,this.default_options),this.anchor&&this.setAnchor(this.anchor),this.cacheOffsets(),this},jaws.Text.prototype.clone=function(){var constructor=this._constructor?eval(this._constructor):this.constructor,new_sprite=new constructor(this.attributes());return new_sprite._constructor=this._constructor||this.constructor.name,new_sprite},jaws.Text.prototype.rotate=function(a){return this.angle+=a,this},jaws.Text.prototype.rotateTo=function(a){return this.angle=a,this},jaws.Text.prototype.moveTo=function(a,b){return this.x=a,this.y=b,this},jaws.Text.prototype.move=function(a,b){return a&&(this.x+=a),b&&(this.y+=b),this},jaws.Text.prototype.setX=function(a){return this.x=a,this},jaws.Text.prototype.setY=function(a){return this.y=a,this},jaws.Text.prototype.setTop=function(a){return this.y=a+this.top_offset,this},jaws.Text.prototype.setBottom=function(a){return this.y=a-this.bottom_offset,this},jaws.Text.prototype.setLeft=function(a){return this.x=a+this.left_offset,this},jaws.Text.prototype.setRight=function(a){return this.x=a-this.right_offset,this},jaws.Text.prototype.setWidth=function(a){return this.width=a,this.cacheOffsets(),this},jaws.Text.prototype.setHeight=function(a){return this.height=a,this.cacheOffsets(),this},jaws.Text.prototype.resize=function(a,b){return this.width+=a,this.height+=b,this.cacheOffsets(),this},jaws.Text.prototype.resizeTo=function(a,b){return this.width=a,this.height=b,this.cacheOffsets(),this},jaws.Text.prototype.setAnchor=function(a){var b={top_left:[0,0],left_top:[0,0],center_left:[0,.5],left_center:[0,.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[.5,0],center_top:[.5,0],center_center:[.5,.5],center:[.5,.5],bottom_center:[.5,1],center_bottom:[.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,.5],right_center:[1,.5],bottom_right:[1,1],right_bottom:[1,1]};return b.hasOwnProperty(a)&&(this.anchor_x=b[a][0],this.anchor_y=b[a][1],this.cacheOffsets()),this},jaws.Text.prototype.cacheOffsets=function(){return this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=this.width*(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this},jaws.Text.prototype.rect=function(){return!this.cached_rect&&this.width&&(this.cached_rect=new jaws.Rect(this.x,this.y,this.width,this.height)),this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset),this.cached_rect},jaws.Text.prototype.draw=function(){this.context.save(),0!==this.angle&&this.context.rotate(this.angle*Math.PI/180),this.context.globalAlpha=this.alpha,this.context.translate(-this.left_offset,-this.top_offset),this.context.fillStyle=this.color,this.context.font=this.style+" "+this.fontSize+"px "+this.fontFace,this.context.textBaseline=this.textBaseline,this.context.textAlign=this.textAlign,this.shadowColor&&(this.context.shadowColor=this.shadowColor),this.shadowBlur&&(this.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var a=this.y,b=this.x;if(this.wordWrap)for(var c=this.text.split(" "),d="",e=0;e<c.length;e++){var f=d+c[e]+" ",g=this.context.measureText(f);this.y<a+this.height&&(g.width>this.width?(this.context.fillText(d,this.x,this.y),d=c[e]+" ",this.y+=this.fontSize):d=f,this.context.fillText(d,this.x,this.y))}else if(this.context.measureText(this.text).width<this.width)this.context.fillText(this.text,this.x,this.y);else for(var c=this.text.split(" "),d=" ",e=0;e<c.length;e++){var f=d+c[e]+" ";this.context.measureText(f).width<Math.abs(this.width-this.x)&&(this.context.fillText(f,this.x,this.y),d=c[e]+" ",d=f)}return this.y=a,this.x=b,this.context.restore(),this},jaws.Text.prototype.asCanvasContext=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height;var b=a.getContext("2d");b.mozImageSmoothingEnabled=jaws.context.mozImageSmoothingEnabled,this.context.fillStyle=this.color,this.context.font=this.style+this.fontSize+"px "+this.fontFace,this.context.textBaseline=this.textBaseline,this.context.textAlign=this.textAlign,this.shadowColor&&(this.context.shadowColor=this.shadowColor),this.shadowBlur&&(this.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var c=this.y,d=this.x;if(this.wordWrap)for(var e=this.text.split(" "),f="",g=0;g<e.length;g++){var h=f+e[g]+" ",i=this.context.measureText(h);this.y<c+this.height&&(i.width>this.width?(this.context.fillText(f,this.x,this.y),f=e[g]+" ",this.y+=this.fontSize):f=h,this.context.fillText(f,this.x,this.y))}else if(this.context.measureText(this.text).width<this.width)this.context.fillText(this.text,this.x,this.y);else for(var e=this.text.split(" "),f=" ",g=0;g<e.length;g++){var h=f+e[g]+" ";this.context.measureText(h).width<Math.abs(this.width-this.x)&&(this.context.fillText(h,this.x,this.y),f=e[g]+" ",f=h)}return this.y=c,this.x=d,b},jaws.Text.prototype.asCanvas=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height;var b=a.getContext("2d");b.mozImageSmoothingEnabled=jaws.context.mozImageSmoothingEnabled,this.context.fillStyle=this.color,this.context.font=this.style+this.fontSize+"px "+this.fontFace,this.context.textBaseline=this.textBaseline,this.context.textAlign=this.textAlign,this.shadowColor&&(this.context.shadowColor=this.shadowColor),this.shadowBlur&&(this.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var c=this.y,d=this.x;if(this.wordWrap)for(var e=this.text.split(" "),f="",g=0;g<e.length;g++){var h=f+e[g]+" ",i=b.measureText(h);this.y<c+this.height&&(i.width>this.width?(b.fillText(f,this.x,this.y),f=e[g]+" ",this.y+=this.fontSize):f=h,b.fillText(f,this.x,this.y))}else if(b.measureText(this.text).width<this.width)this.context.fillText(this.text,this.x,this.y);else for(var e=this.text.split(" "),f=" ",g=0;g<e.length;g++){var h=f+e[g]+" ";b.measureText(h).width<Math.abs(this.width-this.x)&&(b.fillText(h,this.x,this.y),f=e[g]+" ",f=h)}return this.y=c,this.x=d,a},jaws.Text.prototype.toString=function(){return"[Text "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"},jaws.Text.prototype.attributes=function(){var a=this.options;return a._constructor=this._constructor||"jaws.Text",a.x=parseFloat(this.x.toFixed(2)),a.y=parseFloat(this.y.toFixed(2)),a.text=this.text,a.alpha=this.alpha,a.angle=parseFloat(this.angle.toFixed(2)),a.anchor_x=this.anchor_x,a.anchor_y=this.anchor_y,a.style=this.style,a.fontSize=this.fontSize,a.fontFace=this.fontFace,a.color=this.color,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,a.wordWrap=this.wordWrap,a.width=this.width,a.height=this.height,a},jaws.Text.prototype.toJSON=function(){return JSON.stringify(this.attributes())},jaws}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.Text);var jaws=function(a){return a.TileMap=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);a.parseOptions(this,b,this.default_options),this.cells=new Array(this.size[0]);for(var c=0;c<this.size[0];c++){this.cells[c]=new Array(this.size[1]);for(var d=0;d<this.size[1];d++)this.cells[c][d]=[]}},a.TileMap.prototype.default_options={cell_size:[32,32],size:[100,100],sortFunction:null},a.TileMap.prototype.clear=function(){for(var a=0;a<this.size[0];a++)for(var b=0;b<this.size[1];b++)this.cells[a][b]=[]},a.TileMap.prototype.sortCells=function(a){for(var b=0;b<this.size[0];b++)for(var c=0;c<this.size[1];c++)this.cells[b][c].sort(a)},a.TileMap.prototype.push=function(a){var b=this;if(a.forEach)return a.forEach(function(a){b.push(a)}),a;if(a.rect)return this.pushAsRect(a,a.rect());var c=parseInt(a.x/this.cell_size[0]),d=parseInt(a.y/this.cell_size[1]);return this.pushToCell(c,d,a)},a.TileMap.prototype.pushAsPoint=function(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++)this.pushAsPoint(a[b]);return a}var c=parseInt(a.x/this.cell_size[0]),d=parseInt(a.y/this.cell_size[1]);return this.pushToCell(c,d,a)},a.TileMap.prototype.pushAsRect=function(a,b){for(var c=parseInt(b.x/this.cell_size[0]),d=parseInt((b.right-1)/this.cell_size[0]),e=c;d>=e;e++)for(var f=parseInt(b.y/this.cell_size[1]),g=parseInt((b.bottom-1)/this.cell_size[1]),h=f;g>=h;h++)this.pushToCell(e,h,a);return a},a.TileMap.prototype.pushToCell=function(a,b,c){return this.cells[a][b].push(c),this.sortFunction&&this.cells[a][b].sort(this.sortFunction),this},a.TileMap.prototype.at=function(a,b){var c=parseInt(a/this.cell_size[0]),d=parseInt(b/this.cell_size[1]);return this.cells[c][d]},a.TileMap.prototype.atRect=function(a){var b=[];try{var c=parseInt(a.x/this.cell_size[0]);0>c&&(c=0);var d=parseInt(a.right/this.cell_size[0]);d>=this.size[0]&&(d=this.size[0]-1);var e=parseInt(a.y/this.cell_size[1]);0>e&&(e=0);var f=parseInt(a.bottom/this.cell_size[1]);f>=this.size[1]&&(f=this.size[1]-1);for(var g=c;d>=g;g++)for(var h=e;f>=h;h++)this.cells[g][h].forEach(function(a){-1==b.indexOf(a)&&b.push(a)})}catch(i){}return b},a.TileMap.prototype.all=function(){for(var a=[],b=0;b<this.size[0];b++)for(var c=0;c<this.size[1];c++)this.cells[b][c].forEach(function(b){a.push(b)});return a},a.TileMap.prototype.cell=function(a,b){return this.cells[a][b]},a.TileMap.prototype.toString=function(){return"[TileMap "+this.size[0]+" cols, "+this.size[1]+" rows]"},a}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.TileMap);var jaws=function(a){return a.Viewport=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);a.parseOptions(this,b,this.default_options),this.context||(this.context=a.context),this.width||(this.width=a.width),this.height||(this.height=a.height),this.max_x||(this.max_x=a.width),this.max_y||(this.max_y=a.height);var c=this;this.move=function(a,b){a&&(this.x+=a),b&&(this.y+=b),this.verifyPosition()},this.moveTo=function(a,b){void 0!=a&&(this.x=a),void 0!=b&&(this.y=b),this.verifyPosition()},this.isOutside=function(a){return!c.isInside(a)},this.isInside=function(a){return a.x>=c.x&&a.x<=c.x+c.width&&a.y>=c.y&&a.y<=c.y+c.height},this.isPartlyInside=function(a){var b=a.rect();return b.right>=c.x&&b.x<=c.x+c.width&&b.bottom>=c.y&&a.y<=c.y+c.height},this.isLeftOf=function(a){return a.x<c.x},this.isRightOf=function(a){return a.x>c.x+c.width},this.isAbove=function(a){return a.y<c.y},this.isBelow=function(a){return a.y>c.y+c.height},this.centerAround=function(a){this.x=Math.floor(a.x-this.width/2),this.y=Math.floor(a.y-this.height/2),this.verifyPosition()},this.forceInsideVisibleArea=function(b,c){b.x<this.x+c&&(b.x=this.x+c),b.x>this.x+a.width-c&&(b.x=this.x+a.width-c),b.y<this.y+c&&(b.y=this.y+c),b.y>this.y+a.height-c&&(b.y=this.y+a.height-c)},this.forceInside=function(a,b){a.x<b&&(a.x=b),a.x>this.max_x-b&&(a.x=this.max_x-b),a.y<b&&(a.y=b),a.y>this.max_y-b&&(a.y=this.max_y-b)},this.apply=function(a){this.context.save(),this.context.translate(-this.x,-this.y),a(),this.context.restore()},this.draw=function(a){this.apply(function(){a.forEach?a.forEach(c.drawIfPartlyInside):a.draw&&c.drawIfPartlyInside(a)})},this.drawTileMap=function(a){var b=a.atRect({x:this.x,y:this.y,right:this.x+this.width,bottom:this.y+this.height});this.apply(function(){for(var a=0;a<b.length;a++)b[a].draw()})},this.drawIfPartlyInside=function(a){c.isPartlyInside(a)&&a.draw()},this.verifyPosition=function(){var a=this.max_x-this.width;this.x<0&&(this.x=0),this.x>a&&(this.x=a);var a=this.max_y-this.height;this.y<0&&(this.y=0),this.y>a&&(this.y=a)},this.moveTo(b.x||0,b.y||0)},a.Viewport.prototype.default_options={context:null,width:null,height:null,max_x:null,max_y:null,x:0,y:0},a.Viewport.prototype.toString=function(){return"[Viewport "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"},a}(jaws||{}),jaws=function(a){return a.Audio=function b(c){return this instanceof arguments.callee?("undefined"!=typeof b?this.set(c):(a.log.error("jaws.Audio (constructor): 'Audio' object does not exist."),this.audio=null),void 0):new arguments.callee(c)},a.Audio.prototype.default_options={audio:null,autoplay:!1,loop:!1,volume:0,onend:null,onplay:null,onpause:null,_constructor:null},a.Audio.prototype.set=function(b){a.parseOptions(this,b,this.default_options);var c;if(this.audio)if(a.isString(this.audio))c=a.assets.getPostfix(this.audio),a.assets.file_type[c]&&a.assets.can_play[c]?this.setAudio(this.audio):(a.log.warn("jaws.Audio.set: Unknown or unplayable MIME filetype."),this.audio=null);else if(a.isArray(this.audio)){for(var d=0;d<this.audio.length;d++)if(a.isString(this.audio[d])&&(c=a.assets.getPostfix(this.audio[d]),a.assets.file_type[c]&&a.assets.can_play[c])){this.setAudio(this.audio[d]);break}this.audio instanceof Audio||(a.log.warn("jaws.Audio.set: No known or playable MIME filetypes were found."),this.audio=null)}else a.log.error("jaws.Audio.set: Passed in 'audio' property is neither a String nor Array"),this.audio=null;return this},a.Audio.prototype.setAudio=function(b){var c=this;if(a.assets.isLoaded(b)){var d=a.assets.get(b);d instanceof Audio?(this.audio=d,this.volume>=0&&this.volume<=1&&a.isNumber(this.volume)&&(this.audio.volume=this.volume),this.loop&&(this.audio.loop=this.loop),this.onend&&a.isFunction(this.onend)&&this.audio.addEventListener("end",this.onend),this.onplay&&a.isFunction(this.onplay)&&this.audio.addEventListener("play",this.onplay),this.onpause&&a.isFunction(this.onplay)&&this.audio.addEventListener("pause",this.onpause),this.autoplay&&(this.audio.autoplay=this.autoplay)):this.audio=null}else a.log.warn("jaws.Audio.setAudio: Audio '"+b+"' not preloaded with jaws.assets.add()."),a.assets.load(b,function(){var d=a.assets.get(b);d instanceof Audio?(c.audio=d,c.volume>=0&&c.volume<=1&&a.isNumber(c.volume)&&(c.audio.volume=c.volume),c.loop&&(c.audio.loop=c.loop),c.hasOwnProperty("onend")&&a.isFunction(c.onend)&&c.audio.addEventListener("end",c.onend),c.hasOwnProperty("onplay")&&a.isFunction(c.onplay)&&c.audio.addEventListener("play",c.onplay),c.hasOwnProperty("onpause")&&a.isFunction(c.onplay)&&c.audio.addEventListener("pause",c.onpause),c.autoplay&&(c.audio.autoplay=c.autoplay)):c.audio=null},function(){a.log.error("jaws.Audio.setAudio: Could not load Audio resource URL "+b),c.audio=null});return this},a.Audio.prototype.play=function(){this.audio instanceof Audio?this.audio.play():a.log.error("jaws.Audio.play: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.stop=function(){this.audio instanceof Audio?(this.audio.pause(),this.audio.currentTime=0):a.log.error("jaws.Audio.stop: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.pause=function(){this.audio instanceof Audio?this.audio.pause():a.log.error("jaws.Audio.pause: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.mute=function(){this.audio instanceof Audio?this.audio.mute=!0:a.log.error("jaws.Audio.mute: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.unmute=function(){this.audio instanceof Audio?this.audio.mute=!1:a.log.error("jaws.Audio.unmute: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.seekTo=function(b){this.audio instanceof Audio?a.isNumber(b)&&(this.audio.currentTime=b<=this.audio.duration?b:this.audio.duration):a.log.warn("jaws.Audio.seekTo: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.setVolume=function(b){this.audio instanceof Audio?a.isNumber(b)&&1>=b&&b>=0&&(this.audio.volume=b):a.log.warn("jaws.Audio: jaws.setVolume: Either 'audio' was loaded incorrectly or does not exist")},a.Audio.prototype.isLoaded=function(){return this.audio instanceof Audio},a.Audio.prototype.toString=function(){var a="[Audio ";return this.audio instanceof Audio?(a+=this.audio.src+", ",a+=this.audio.currentTime+", ",a+=this.audio.duration+", ",a+=this.audio.volume+" ]"):a+="null ]",a},a.Audio.prototype.attributes=function(){var a=this.options;return a._constructor=this._constructor||"jaws.Audio",this.audio instanceof Audio?(a.audio=this.audio.src,a.loop=this.loop,a.muted=this.audio.muted,a.volume=this.audio.volume):a.audio=null,this.hasOwnProperty("autoplay")&&(a.autoplay=this.autoplay),a},a.Audio.prototype.toJSON=function(){return JSON.stringify(this.attributes())},a}(jaws||{});"undefined"!=typeof module&&"exports"in module&&(module.exports=jaws.Audio);var jaws=function(jaws){return jaws.SpriteList=function(a){return this instanceof arguments.callee?(this.sprites=[],this.length=0,a&&this.load(a),void 0):new arguments.callee(a)},jaws.SpriteList.prototype.add=function(){var a=arguments;if(1==a.length&&jaws.isArray(a[0])&&(a=a[0]),a.length>1)for(var b=0;b<a.length;b++)this.sprites.push(a[b]);else this.sprites.push(arguments);return this.updateLength(),this},jaws.SpriteList.prototype.at=function(a){return this.sprites[a]},jaws.SpriteList.prototype.concat=function(){return this.sprites.concat.apply(this.sprites,arguments)},jaws.SpriteList.prototype.indexOf=function(a,b){return this.sprites.indexOf(a,b)},jaws.SpriteList.prototype.join=function(a){return this.sprites.join(a)},jaws.SpriteList.prototype.lastIndexOf=function(){return this.sprites.lastIndexOf.apply(this.sprites,arguments)},jaws.SpriteList.prototype.pop=function(){var a=this.sprites.pop();return this.updateLength(),a},jaws.SpriteList.prototype.push=function(){return this.sprites.push.apply(this.sprites,arguments),this.updateLength(),this.length},jaws.SpriteList.prototype.reverse=function(){this.sprites.reverse()},jaws.SpriteList.prototype.shift=function(){var a=this.sprites.shift();return this.updateLength(),a},jaws.SpriteList.prototype.slice=function(a,b){return this.sprites.slice(a,b)},jaws.SpriteList.prototype.sort=function(){this.sprites.sort.apply(this.sprites,arguments)},jaws.SpriteList.prototype.splice=function(){var a=this.sprites.splice.apply(this.sprites,arguments);return this.updateLength(),a},jaws.SpriteList.prototype.unshift=function(){return this.sprites.unshift.apply(this.sprites,arguments),this.updateLength(),this.length},jaws.SpriteList.prototype.updateLength=function(){this.length=this.sprites.length},jaws.SpriteList.prototype.valueOf=function(){return this.toString()},jaws.SpriteList.prototype.filter=function(){return this.sprites.filter.apply(this.sprites,arguments)},jaws.SpriteList.prototype.forEach=function(){this.sprites.forEach.apply(this.sprites,arguments),this.updateLength()},jaws.SpriteList.prototype.every=function(){return this.sprites.every.apply(this.sprites,arguments)},jaws.SpriteList.prototype.map=function(){return this.sprites.map.apply(this.sprites,arguments)},jaws.SpriteList.prototype.reduce=function(){return this.sprites.reduce.apply(this.sprites,arguments)},jaws.SpriteList.prototype.reduceRight=function(){return this.sprites.reduceRight.apply(this.sprites,arguments)},jaws.SpriteList.prototype.some=function(){return this.sprites.some.apply(this.sprites,arguments)},jaws.SpriteList.prototype.isSpriteList=function(){return!0},jaws.SpriteList.prototype.load=function(objects){function parseArray(array){array.forEach(function(data){var constructor=data._constructor?eval(data._constructor):data.constructor;if(jaws.isFunction(constructor)){jaws.log.info("Creating "+data._constructor+"("+data.toString()+")",!0);var object=new constructor(data);object._constructor=data._constructor||data.constructor.name,that.push(object)}})}var that=this;jaws.isArray(objects)?objects.every(function(a){return a._constructor})?parseArray(objects):this.sprites=objects:jaws.isString(objects)&&(parseArray(JSON.parse(objects)),jaws.log.info(objects)),this.updateLength()},jaws.SpriteList.prototype.remove=function(a){var b=this.indexOf(a);b>-1&&this.splice(b,1),this.updateLength()},jaws.SpriteList.prototype.draw=function(){this.forEach(function(a){a.draw()})},jaws.SpriteList.prototype.drawIf=function(a){this.forEach(function(b){a(b)&&b.draw()})},jaws.SpriteList.prototype.update=function(){this.forEach(function(a){a.update()})},jaws.SpriteList.prototype.updateIf=function(a){this.forEach(function(b){a(b)&&b.update()})},jaws.SpriteList.prototype.deleteIf=function(a){this.removeIf(a)},jaws.SpriteList.prototype.removeIf=function(a){this.sprites=this.filter(function(b){return!a(b)}),this.updateLength()},jaws.SpriteList.prototype.toString=function(){return"[SpriteList "+this.length+" sprites]"},jaws}(jaws||{}),jaws=function(a){return a.TileMap.prototype.findPath=function(a,b,c){"undefined"==typeof c&&(c=!1);var d=parseInt(a[0]/this.cell_size[0]),e=parseInt(a[1]/this.cell_size[1]),f=parseInt(b[0]/this.cell_size[0]),g=parseInt(b[1]/this.cell_size[1]);if(d===f&&e===g)return[{x:a[0],y:a[1]}];for(var h=d,i=e,j=0,k=0,l=this.size[0]*this.size[1]*2+1,m=new Array(this.size[0]),n=0;n<this.size[0];n++){m[n]=new Array(this.size[1]);for(var o=0;o<this.size[1];o++)m[n][o]=!1}m[h][i]={parent:[],G:0,score:l};for(var p=new Array(this.size[0]),n=0;n<this.size[0];n++){p[n]=new Array(this.size[1]);for(var o=0;o<this.size[1];o++)p[n][o]=!1}for(var q=function(a,b){return Math.abs(b[0]-a[0])+Math.abs(b[1]-a[1])},r=function(a,b){return p[a][b]?!0:!1};h!==f||i!==g;){var s=[];h>0&&s.push([h-1,i]),h<this.size[0]-1&&s.push([h+1,i]),i>0&&s.push([h,i-1]),i<this.size[1]-1&&s.push([h,i+1]);for(var n=0;n<s.length;n++){var t=s[n][0],u=s[n][1];(0===this.cell(t,u).length&&!c||this.cell(t,u).length>0&&c)&&!r(t,u)&&(k=j+1+q([t,u],[f,g]),(!m[t][u]||m[t][u]&&m[t][u].score>k)&&(m[t][u]={parent:[h,i],G:j+1,score:k}))}for(var v={node:[],parent:[],score:l,G:0},n=0;n<this.size[0];n++)for(var o=0;o<this.size[1];o++)m[n][o]&&m[n][o].score<v.score&&(v.node=[n,o],v.parent=m[n][o].parent,v.score=m[n][o].score,v.G=m[n][o].G);if(0===v.node.length)return[];m[v.node[0]][v.node[1]]=!1,h=v.node[0],i=v.node[1],j=v.G,p[h][i]={parent:v.parent}}var w=[],x=p[h][i];for(w.unshift({x:h*this.cell_size[0],y:i*this.cell_size[1]});h!==d||i!==e;)h=x.parent[0],i=x.parent[1],w.unshift({x:h*this.cell_size[0],y:i*this.cell_size[1]}),x=p[h][i];return w},a.TileMap.prototype.lineOfSight=function(a,b,c){"undefined"==typeof c&&(c=!1);var d,e,f=a[0],g=b[0],h=a[1],i=b[1],j=Math.abs(g-f),k=Math.abs(i-h);d=g>f?1:-1,e=i>h?1:-1;for(var l,m=j-k;f!==g||h!==i;){if(c){if(0===this.at(f,h).length)return!1}else if(this.at(f,h).length>0)return!1;l=2*m,l>-k&&(m-=k,f+=d),j>l&&(m+=j,h+=e)}return!0},a}(jaws||{});